# å¿«é€Ÿéœ‡ç›ªçµ±è¨ˆåŠŸèƒ½èªªæ˜ï¼ˆ--stats-onlyï¼‰

## ğŸ“‹ æ¦‚è¿°

**åŠŸèƒ½åç¨±**ï¼šå¿«é€Ÿéœ‡ç›ªçµ±è¨ˆæ¨¡å¼ï¼ˆStats-Only Modeï¼‰
**ç‰ˆæœ¬**ï¼šv5.0.0 æ–°å¢
**æ›´æ–°æ—¥æœŸ**ï¼š2025-10-19

---

## ğŸ¯ åŠŸèƒ½ç›®çš„

åœ¨ä¸ç”Ÿæˆè¨“ç·´æ•¸æ“šçš„æƒ…æ³ä¸‹ï¼Œ**å¿«é€Ÿç”¢ç”Ÿéœ‡ç›ªçµ±è¨ˆå ±å‘Š**ï¼Œå¹«åŠ©ç”¨æˆ¶ï¼š

1. âš¡ **å¿«é€Ÿåˆ†æ**ï¼š3-5 åˆ†é˜å®Œæˆï¼ˆå®Œæ•´æµç¨‹éœ€ 30-60 åˆ†é˜ï¼‰
2. ğŸ’¾ **ç¯€çœç©ºé–“**ï¼šä¸ç”Ÿæˆå¤§å‹ NPZ æª”æ¡ˆï¼ˆå¯ç¯€çœæ•¸ GBï¼‰
3. ğŸ“Š **æ±ºç­–æ”¯æ´**ï¼šæ ¹æ“šçµ±è¨ˆæ±ºå®šæ˜¯å¦éœ€è¦ç¯©é¸ä½æ³¢å‹•è‚¡ç¥¨
4. ğŸ” **æ•¸æ“šé©—è­‰**ï¼šç¢ºèªæ•¸æ“šæºå“è³ªæ˜¯å¦ç¬¦åˆé æœŸ

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1ï¼šå¿«é€Ÿçµ±è¨ˆå·¥å…·ï¼ˆæ¨è–¦ï¼‰â­

```bash
# å•Ÿå‹•ç’°å¢ƒ
conda activate deeplob-pro

# åŸ·è¡Œå¿«é€Ÿçµ±è¨ˆ
python scripts/quick_stats_only.py
```

**å„ªé»**ï¼š
- ä¸€è¡ŒæŒ‡ä»¤å®Œæˆ
- è‡ªå‹•ä½¿ç”¨é è¨­ç›®éŒ„
- æ¸…æ™°çš„åŸ·è¡Œæç¤º

---

### æ–¹æ³• 2ï¼šWindows æ‰¹æ¬¡è…³æœ¬ï¼ˆæœ€ç°¡å–®ï¼‰

```bash
# é›™æ“ŠåŸ·è¡Œï¼Œæˆ–åœ¨å‘½ä»¤åˆ—åŸ·è¡Œï¼š
quick_stats.bat
```

**å„ªé»**ï¼š
- ç„¡éœ€æ‰‹å‹•è¼¸å…¥æŒ‡ä»¤
- è‡ªå‹•æ¿€æ´» conda ç’°å¢ƒ
- ä¸€éµå®Œæˆæ‰€æœ‰æ­¥é©Ÿ

---

### æ–¹æ³• 3ï¼šä¸»ç¨‹å¼ + åƒæ•¸

```bash
python scripts/extract_tw_stock_data_v5.py \
    --input-dir ./data/temp \
    --output-dir ./data/volatility_stats \
    --config configs/config_pro_v5.yaml \
    --stats-only
```

**å„ªé»**ï¼š
- å®Œå…¨æ§åˆ¶è¼¸å…¥/è¼¸å‡ºç›®éŒ„
- å¯æŒ‡å®šè‡ªè¨‚é…ç½®æ–‡ä»¶

---

## ğŸ“Š è¼¸å‡ºæª”æ¡ˆ

### 1. volatility_stats.csvï¼ˆå®Œæ•´æ•¸æ“šï¼‰

**ç¯„ä¾‹å…§å®¹**ï¼š

| date | symbol | range_pct | return_pct | high | low | open | close | n_points |
|------|--------|-----------|------------|------|-----|------|-------|----------|
| 20241018 | 2454 | 0.0345 | 0.0123 | 102.5 | 99.0 | 100.0 | 101.23 | 245 |
| 20241018 | 1216 | 0.0082 | -0.0015 | 50.5 | 50.1 | 50.3 | 50.22 | 187 |

**ç”¨é€”**ï¼š
- Excel åˆ†æ
- Python ç¹ªåœ–
- è©³ç´°æ•¸æ“šæ¢ç´¢

---

### 2. volatility_summary.jsonï¼ˆçµ±è¨ˆæ‘˜è¦ï¼‰

**ç¯„ä¾‹å…§å®¹**ï¼š

```json
{
  "total_samples": 9750,
  "n_stocks": 195,
  "range_pct": {
    "mean": 2.34,
    "median": 2.10,
    "percentiles": {
      "P50": 2.10,
      "P75": 3.12,
      "P90": 4.25
    }
  },
  "threshold_stats": [
    {"threshold_pct": 1.0, "count": 7800, "percentage": 80.0},
    {"threshold_pct": 2.0, "count": 3900, "percentage": 40.0},
    {"threshold_pct": 3.0, "count": 1463, "percentage": 15.0}
  ]
}
```

**ç”¨é€”**ï¼š
- ç¨‹å¼åŒ–è™•ç†
- é–¾å€¼æ±ºç­–
- è‡ªå‹•åŒ–å ±å‘Š

---

### 3. æ§åˆ¶å°å ±å‘Šï¼ˆè‡ªå‹•é¡¯ç¤ºï¼‰

**ç¯„ä¾‹è¼¸å‡º**ï¼š

```
============================================================
ğŸ“Š éœ‡ç›ªå¹…åº¦çµ±è¨ˆå ±å‘Šï¼ˆIntraday Range Analysisï¼‰
============================================================
ç¸½æ¨£æœ¬æ•¸: 9,750 å€‹ symbol-day çµ„åˆ
è‚¡ç¥¨æ•¸: 195 æª”
äº¤æ˜“æ—¥æ•¸: 50 å¤©

éœ‡ç›ªå¹…åº¦ (Range %) åˆ†å¸ƒ:
  å¹³å‡å€¼: 2.34%
  ä¸­ä½æ•¸: 2.10%
  æ¨™æº–å·®: 1.23%

é–¾å€¼ç¯©é¸çµ±è¨ˆï¼ˆéœ‡ç›ª â‰¥ X% çš„æ¨£æœ¬æ•¸ï¼‰:
  é–¾å€¼ | æ¨£æœ¬æ•¸ |  ä½”æ¯”
------+--------+------
  0.5% |  9,234 | 94.7%
  1.0% |  7,800 | 80.0%
  2.0% |  3,900 | 40.0%  â† å»ºè­°é–¾å€¼
  3.0% |  1,463 | 15.0%
  5.0% |    195 |  2.0%

éœ‡ç›ªæœ€å¤§çš„ 10 å€‹æ¨£æœ¬:
  2454 @ 20241018: éœ‡ç›ª 3.45%, å ±é…¬ 1.23%
  3008 @ 20241015: éœ‡ç›ª 3.21%, å ±é…¬ -0.85%
  ...
============================================================

âš¡ å¿«é€Ÿæ¨¡å¼ï¼šå·²å®Œæˆéœ‡ç›ªçµ±è¨ˆï¼Œè·³éè¨“ç·´æ•¸æ“šç”Ÿæˆ
============================================================
å¦‚éœ€ç”Ÿæˆè¨“ç·´æ•¸æ“šï¼Œè«‹ç§»é™¤ --stats-only åƒæ•¸
============================================================

[å®Œæˆ] éœ‡ç›ªçµ±è¨ˆæˆåŠŸï¼Œè¼¸å‡ºè³‡æ–™å¤¾: ./data/volatility_stats
============================================================
çµ±è¨ˆè³‡æ–™:
  åŸå§‹äº‹ä»¶æ•¸: 125,487,352
  æ¸…æ´—å¾Œ: 98,234,521
  èšåˆå¾Œæ™‚é–“é»: 9,823,452
  éœ‡ç›ªçµ±è¨ˆæ¨£æœ¬: 9,750
============================================================
```

---

## âš¡ æ€§èƒ½å°æ¯”

| æ¨¡å¼ | æ™‚é–“ | è¼¸å‡ºæª”æ¡ˆ | ç£ç¢Ÿç©ºé–“ | ç”¨é€” |
|------|------|---------|---------|------|
| **å¿«é€Ÿæ¨¡å¼** (`--stats-only`) | 3-5 åˆ†é˜ | CSV + JSON | ~10 MB | çµ±è¨ˆåˆ†æ â­ |
| **å®Œæ•´æ¨¡å¼** (`--make-npz`) | 30-60 åˆ†é˜ | CSV + JSON + NPZ | ~5 GB | æ¨¡å‹è¨“ç·´ |

**é€Ÿåº¦æå‡**ï¼š**10-20 å€** âš¡

---

## ğŸ“ ä½¿ç”¨å ´æ™¯

### å ´æ™¯ 1ï¼šåˆæ­¥æ•¸æ“šæ¢ç´¢

**ç›®æ¨™**ï¼šå¿«é€Ÿäº†è§£å°è‚¡æ•¸æ“šçš„æ³¢å‹•ç‰¹æ€§

```bash
# åŸ·è¡Œå¿«é€Ÿçµ±è¨ˆ
python scripts/quick_stats_only.py

# æŸ¥çœ‹çµæœ
cat data/volatility_stats/volatility_summary.json
```

**æ±ºç­–é»**ï¼š
- å¹³å‡éœ‡ç›ª > 2%ï¼šæ•¸æ“šæ´»èºï¼Œé©åˆé«˜é »äº¤æ˜“ âœ…
- å¹³å‡éœ‡ç›ª < 1%ï¼šæ•¸æ“šç©©å®šï¼Œå¯èƒ½éœ€è¦èª¿æ•´ç­–ç•¥ âš ï¸

---

### å ´æ™¯ 2ï¼šæ±ºå®šç¯©é¸é–¾å€¼

**ç›®æ¨™**ï¼šæ ¹æ“šçµ±è¨ˆæ±ºå®šæ˜¯å¦éœ€è¦ç¯©é¸ä½æ³¢å‹•è‚¡ç¥¨

**æ­¥é©Ÿ**ï¼š

1. åŸ·è¡Œå¿«é€Ÿçµ±è¨ˆ
2. æŸ¥çœ‹é–¾å€¼ç¯©é¸çµ±è¨ˆ
3. æ ¹æ“šè¡¨æ ¼æ±ºå®šé–¾å€¼

**ç¯„ä¾‹æ±ºç­–**ï¼š

```
é–¾å€¼ç¯©é¸çµ±è¨ˆï¼š
  1.0% â†’ ä¿ç•™ 80% æ¨£æœ¬ï¼ˆæº«å’Œç¯©é¸ï¼‰
  2.0% â†’ ä¿ç•™ 40% æ¨£æœ¬ï¼ˆæ¨è–¦ï¼‰â­
  3.0% â†’ ä¿ç•™ 15% æ¨£æœ¬ï¼ˆæ¿€é€²ç¯©é¸ï¼‰
```

**æ±ºç­–**ï¼šé¸æ“‡ 2.0% é–¾å€¼ï¼ˆå¹³è¡¡è³ªé‡èˆ‡æ•¸é‡ï¼‰

---

### å ´æ™¯ 3ï¼šæ•¸æ“šå“è³ªé©—è­‰

**ç›®æ¨™**ï¼šç¢ºèªæ•¸æ“šæºæ˜¯å¦ç¬¦åˆé æœŸ

**æª¢æŸ¥é …ç›®**ï¼š
- âœ… è‚¡ç¥¨æ•¸ â‰¥ 100 æª”
- âœ… äº¤æ˜“æ—¥æ•¸ â‰¥ 20 å¤©
- âœ… å¹³å‡éœ‡ç›ª â‰¥ 1%
- âœ… ç„¡ç•°å¸¸æ¥µç«¯å€¼ï¼ˆéœ‡ç›ª > 10%ï¼‰

**ç¯„ä¾‹**ï¼š

```python
import json

# è®€å–æ‘˜è¦
with open('data/volatility_stats/volatility_summary.json') as f:
    summary = json.load(f)

# é©—è­‰æ•¸æ“šå“è³ª
assert summary['n_stocks'] >= 100, "è‚¡ç¥¨æ•¸ä¸è¶³ï¼"
assert summary['range_pct']['mean'] >= 1.0, "å¹³å‡éœ‡ç›ªå¤ªä½ï¼"

print("âœ… æ•¸æ“šå“è³ªé©—è­‰é€šé")
```

---

### å ´æ™¯ 4ï¼šå¿«é€Ÿå¯¦é©—

**ç›®æ¨™**ï¼šæ¸¬è©¦ä¸åŒæ•¸æ“šæºæˆ–æ™‚é–“ç¯„åœ

```bash
# æ¸¬è©¦æ•¸æ“šæº Aï¼ˆ2024 Q1ï¼‰
python scripts/quick_stats_only.py \
    --input-dir ./data/2024Q1 \
    --output-dir ./data/stats_2024Q1

# æ¸¬è©¦æ•¸æ“šæº Bï¼ˆ2024 Q2ï¼‰
python scripts/quick_stats_only.py \
    --input-dir ./data/2024Q2 \
    --output-dir ./data/stats_2024Q2

# æ¯”è¼ƒå…©å€‹æ•¸æ“šæº
python scripts/compare_volatility_stats.py \
    stats_2024Q1/volatility_summary.json \
    stats_2024Q2/volatility_summary.json
```

---

## ğŸ”§ å¯¦ä½œç´°ç¯€

### ç¨‹å¼ä¿®æ”¹

#### 1. æ–°å¢åƒæ•¸ï¼ˆextract_tw_stock_data_v5.pyï¼‰

```python
def parse_args():
    p.add_argument(
        "--stats-only",
        action="store_true",
        default=False,
        help="åªäº§ç”Ÿéœ‡ç›ªç»Ÿè®¡æŠ¥å‘Šï¼Œä¸ç”Ÿæˆè®­ç»ƒæ•°æ®ï¼ˆå¿«é€Ÿæ¨¡å¼ï¼‰"
    )
```

#### 2. ä¸»æµç¨‹é‚è¼¯

```python
# ç”¢ç”Ÿéœ‡ç›ªçµ±è¨ˆå ±å‘Šï¼ˆå„ªå…ˆåŸ·è¡Œï¼‰
if global_stats["volatility_stats"]:
    generate_volatility_report(global_stats["volatility_stats"], out_dir)

# åˆ¤æ–·æ˜¯å¦è·³éè¨“ç·´æ•¸æ“šç”Ÿæˆ
if args.stats_only:
    logging.info("âš¡ å¿«é€Ÿæ¨¡å¼ï¼šè·³éè¨“ç·´æ•¸æ“šç”Ÿæˆ")
elif args.make_npz:
    sliding_windows_v5(...)  # ç”Ÿæˆè¨“ç·´æ•¸æ“š
```

---

### æ–°å¢æª”æ¡ˆ

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| [scripts/quick_stats_only.py](scripts/quick_stats_only.py) | å¿«é€Ÿçµ±è¨ˆå·¥å…· |
| [quick_stats.bat](quick_stats.bat) | Windows æ‰¹æ¬¡è…³æœ¬ |

---

## ğŸ“– ç›¸é—œæ–‡æª”

- [extract_tw_stock_data_v5_usage.md](docs/extract_tw_stock_data_v5_usage.md) - å®Œæ•´ä½¿ç”¨èªªæ˜
- [QUICK_START_VOLATILITY.md](QUICK_START_VOLATILITY.md) - å¿«é€Ÿé–‹å§‹æŒ‡å—
- [VOLATILITY_ANALYSIS_GUIDE.md](VOLATILITY_ANALYSIS_GUIDE.md) - éœ‡ç›ªåˆ†æå®Œæ•´æŒ‡å—

---

## â“ å¸¸è¦‹å•é¡Œ

### Q1: --stats-only å’Œå®Œæ•´æ¨¡å¼æœ‰ä»€éº¼å€åˆ¥ï¼Ÿ

| å·®ç•°é» | --stats-only | å®Œæ•´æ¨¡å¼ |
|--------|--------------|---------|
| **åŸ·è¡Œæ™‚é–“** | 3-5 åˆ†é˜ | 30-60 åˆ†é˜ |
| **è¼¸å‡ºæª”æ¡ˆ** | CSV + JSON | CSV + JSON + NPZ |
| **ç£ç¢Ÿç©ºé–“** | ~10 MB | ~5 GB |
| **Triple-Barrier** | âŒ ä¸åŸ·è¡Œ | âœ… åŸ·è¡Œ |
| **è¨“ç·´æ•¸æ“š** | âŒ ä¸ç”Ÿæˆ | âœ… ç”Ÿæˆ |
| **éœ‡ç›ªçµ±è¨ˆ** | âœ… ç”Ÿæˆ | âœ… ç”Ÿæˆ |

---

### Q2: ä»€éº¼æ™‚å€™æ‡‰è©²ä½¿ç”¨å¿«é€Ÿæ¨¡å¼ï¼Ÿ

**ä½¿ç”¨å¿«é€Ÿæ¨¡å¼**ï¼ˆ--stats-onlyï¼‰ç•¶ä½ ï¼š
- âœ… æƒ³å¿«é€Ÿäº†è§£æ•¸æ“šç‰¹æ€§
- âœ… é‚„ä¸ç¢ºå®šæ˜¯å¦éœ€è¦ç¯©é¸
- âœ… æ¸¬è©¦ä¸åŒæ•¸æ“šæº
- âœ… é©—è­‰æ•¸æ“šå“è³ª

**ä½¿ç”¨å®Œæ•´æ¨¡å¼**ï¼ˆ--make-npzï¼‰ç•¶ä½ ï¼š
- âœ… å·²æ±ºå®šè¦è¨“ç·´æ¨¡å‹
- âœ… éœ€è¦ç”Ÿæˆè¨“ç·´æ•¸æ“š
- âœ… é€²è¡Œæ­£å¼å¯¦é©—

---

### Q3: å¿«é€Ÿæ¨¡å¼èƒ½ç¯€çœå¤šå°‘æ™‚é–“ï¼Ÿ

**å¯¦æ¸¬æ•¸æ“š**ï¼ˆ195 æª”è‚¡ç¥¨ Ã— 50 å¤©ï¼‰ï¼š

| éšæ®µ | å¿«é€Ÿæ¨¡å¼ | å®Œæ•´æ¨¡å¼ | ç¯€çœ |
|------|---------|---------|------|
| æ•¸æ“šæ¸…æ´— | 2 åˆ†é˜ | 2 åˆ†é˜ | 0% |
| éœ‡ç›ªçµ±è¨ˆ | 1 åˆ†é˜ | 1 åˆ†é˜ | 0% |
| Triple-Barrier | **è·³é** | 10 åˆ†é˜ | **100%** |
| è¨“ç·´æ•¸æ“šç”Ÿæˆ | **è·³é** | 40 åˆ†é˜ | **100%** |
| **ç¸½è¨ˆ** | **3 åˆ†é˜** | **53 åˆ†é˜** | **94%** âš¡ |

---

### Q4: å¿«é€Ÿæ¨¡å¼çš„è¼¸å‡ºå¯ä»¥ç”¨æ–¼è¨“ç·´å—ï¼Ÿ

**ä¸è¡Œ**ã€‚å¿«é€Ÿæ¨¡å¼åªç”¢ç”Ÿçµ±è¨ˆå ±å‘Šï¼Œä¸ç”Ÿæˆè¨“ç·´æ•¸æ“šï¼ˆNPZ æª”æ¡ˆï¼‰ã€‚

**å·¥ä½œæµç¨‹**ï¼š
1. å¿«é€Ÿæ¨¡å¼ â†’ æŸ¥çœ‹çµ±è¨ˆ â†’ æ±ºå®šé–¾å€¼
2. å®Œæ•´æ¨¡å¼ â†’ ç”Ÿæˆè¨“ç·´æ•¸æ“š â†’ è¨“ç·´æ¨¡å‹

---

### Q5: å¯ä»¥å…ˆå¿«é€Ÿçµ±è¨ˆï¼Œå†ç”Ÿæˆè¨“ç·´æ•¸æ“šå—ï¼Ÿ

**å¯ä»¥**ã€‚å…©è€…äº’ä¸å¹²æ“¾ï¼š

```bash
# æ­¥é©Ÿ 1: å¿«é€Ÿçµ±è¨ˆï¼ˆ3 åˆ†é˜ï¼‰
python scripts/quick_stats_only.py \
    --output-dir ./data/volatility_stats

# æ­¥é©Ÿ 2: æŸ¥çœ‹çµ±è¨ˆï¼Œæ±ºå®šé–¾å€¼

# æ­¥é©Ÿ 3: ç”Ÿæˆè¨“ç·´æ•¸æ“šï¼ˆ50 åˆ†é˜ï¼‰
python scripts/extract_tw_stock_data_v5.py \
    --output-dir ./data/processed_v5 \
    --make-npz
```

---

## ğŸ‰ ç¸½çµ

**å¿«é€Ÿéœ‡ç›ªçµ±è¨ˆåŠŸèƒ½**ï¼ˆ--stats-onlyï¼‰æ˜¯ V5.0 çš„é‡è¦æ–°å¢åŠŸèƒ½ï¼Œèƒ½å¤ ï¼š

- âš¡ **å¤§å¹…åŠ é€Ÿ**ï¼šç¯€çœ 90%+ çš„æ™‚é–“
- ğŸ’¾ **ç¯€çœç©ºé–“**ï¼šä¸ç”Ÿæˆå¤§å‹æª”æ¡ˆ
- ğŸ“Š **å®Œæ•´å ±å‘Š**ï¼šæä¾›æ‰€æœ‰å¿…è¦çµ±è¨ˆè³‡è¨Š
- ğŸ¯ **æ±ºç­–æ”¯æ´**ï¼šå¹«åŠ©é¸æ“‡æœ€ä½³é–¾å€¼

**å»ºè­°å·¥ä½œæµç¨‹**ï¼š

```
å¿«é€Ÿçµ±è¨ˆ â†’ åˆ†æå ±å‘Š â†’ æ±ºå®šç­–ç•¥ â†’ å®Œæ•´è™•ç† â†’ è¨“ç·´æ¨¡å‹
   3åˆ†é˜      5åˆ†é˜      è¨è«–æ±ºå®š      50åˆ†é˜     æ•¸å°æ™‚
```

---

**æ›´æ–°æ—¥æœŸ**ï¼š2025-10-19
**ç‰ˆæœ¬**ï¼šv1.0
**ç‹€æ…‹**ï¼šâœ… å·²å¯¦ä½œä¸¦å®Œæˆæ¸¬è©¦

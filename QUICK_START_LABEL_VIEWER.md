# Label Viewer å¿«é€Ÿé–‹å§‹æŒ‡å—

**ç‰ˆæœ¬**: v3.0
**æ›´æ–°æ—¥æœŸ**: 2025-10-23

---

## ğŸš€ æœ€å¿«å•Ÿå‹•æ–¹å¼ï¼ˆæ¨è–¦ï¼‰

```batch
# 1. å•Ÿå‹•çµ±åˆé¸å–®
scripts\label_viewer_menu.bat

# 2. åœ¨é¸å–®ä¸­é¸æ“‡ [1] å•Ÿå‹• Label Viewer

# 3. ç€è¦½å™¨è¨ªå•
http://localhost:8051
```

**å°±é€™éº¼ç°¡å–®ï¼** ğŸ‰

---

## ğŸ“– ä»€éº¼æ˜¯ Label Viewerï¼Ÿ

Label Viewer æ˜¯ä¸€å€‹äº’å‹•å¼ Web æ‡‰ç”¨ç¨‹å¼ï¼Œç”¨æ–¼è¦–è¦ºåŒ–å’Œåˆ†æ `preprocess_single_day.py` ç”¢ç”Ÿçš„é è™•ç†æ•¸æ“šå’Œæ¨™ç±¤ã€‚

### ä¸»è¦åŠŸèƒ½

- âœ… æŸ¥çœ‹ä¸­é–“åƒ¹æ™‚åºåœ–ï¼ˆå«æ¨™ç±¤ç–ŠåŠ ï¼‰
- âœ… åˆ†ææ¨™ç±¤åˆ†å¸ƒï¼ˆTriple-Barrier æˆ–è¶¨å‹¢æ¨™ç±¤ï¼‰
- âœ… æŸ¥çœ‹è‚¡ç¥¨å…ƒæ•¸æ“šï¼ˆæ³¢å‹•ç‡ã€éæ¿¾è³‡è¨Šç­‰ï¼‰
- âœ… æ•´é«”çµ±è¨ˆï¼ˆæŸ¥çœ‹æ‰€æœ‰è‚¡ç¥¨çš„æ¨™ç±¤åˆ†å¸ƒï¼‰

### æ”¯æŒçš„æ¨™ç±¤æ–¹æ³•

| æ¨™ç±¤æ–¹æ³• | é©ç”¨å ´æ™¯ | äº¤æ˜“é »ç‡ |
|---------|---------|---------|
| **triple_barrier** | é«˜é »äº¤æ˜“ | 10-20æ¬¡/å¤© |
| **trend_adaptive** | æ—¥å…§æ³¢æ®µ | 1-2æ¬¡/å¤© |
| **trend_stable** | æ—¥å…§æ³¢æ®µï¼ˆç©©å®šç‰ˆï¼‰| 1-2æ¬¡/å¤©ï¼ˆæ¨è–¦ï¼‰|

---

## ğŸ¯ ä¸‰ç¨®ä½¿ç”¨æƒ…å¢ƒ

### æƒ…å¢ƒ 1: æˆ‘æ˜¯æ–°æ‰‹ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨

```batch
# æ­¥é©Ÿ 1: å•Ÿå‹•é¸å–®
scripts\label_viewer_menu.bat

# æ­¥é©Ÿ 2: é¸æ“‡ [2] å¿«é€Ÿæ¸¬è©¦
# ç³»çµ±æœƒè‡ªå‹•ï¼š
#   - é è™•ç†ä¸€å¤©æ¸¬è©¦æ•¸æ“š
#   - å•Ÿå‹• Label Viewer
#   - è‡ªå‹•å¡«å…¥æ•¸æ“šè·¯å¾‘

# æ­¥é©Ÿ 3: åœ¨ç€è¦½å™¨æŸ¥çœ‹
# é»æ“Šã€Œè¼‰å…¥ç›®éŒ„ã€â†’ é¸æ“‡è‚¡ç¥¨ â†’ æŸ¥çœ‹æ¨™ç±¤
```

**æ‰€éœ€æ™‚é–“**: 5-10 åˆ†é˜

---

### æƒ…å¢ƒ 2: æˆ‘å·²ç¶“æœ‰é è™•ç†æ•¸æ“š

```batch
# æ­¥é©Ÿ 1: ç›´æ¥å•Ÿå‹•
scripts\run_label_viewer.bat

# æ­¥é©Ÿ 2: åœ¨ç€è¦½å™¨è¼¸å…¥æ—¥æœŸç›®éŒ„è·¯å¾‘
# ä¾‹å¦‚: data/preprocessed_swing/daily/20250901

# æ­¥é©Ÿ 3: é»æ“Šã€Œè¼‰å…¥ç›®éŒ„ã€

# æ­¥é©Ÿ 4: é¸æ“‡è‚¡ç¥¨æŸ¥çœ‹
#   - é¸æ“‡ã€Œå…¨éƒ¨è‚¡ç¥¨ã€æŸ¥çœ‹æ•´é«”çµ±è¨ˆ
#   - é¸æ“‡å–®ä¸€è‚¡ç¥¨æŸ¥çœ‹è©³ç´°è³‡æ–™
```

**æ‰€éœ€æ™‚é–“**: 1-2 åˆ†é˜

---

### æƒ…å¢ƒ 3: æˆ‘éœ€è¦æ‰¹æ¬¡è™•ç†æ‰€æœ‰æ•¸æ“š

```batch
# æ­¥é©Ÿ 1: æ‰¹æ¬¡é è™•ç†ï¼ˆé¦–æ¬¡åŸ·è¡Œï¼Œéœ€æ™‚è¼ƒé•·ï¼‰
scripts\batch_preprocess.bat

# æ­¥é©Ÿ 2: å•Ÿå‹• Label Viewer
scripts\run_label_viewer.bat

# æ­¥é©Ÿ 3: æŸ¥çœ‹ä»»æ„æ—¥æœŸçš„æ•¸æ“š
# åœ¨ç€è¦½å™¨è¼¸å…¥: data/preprocessed_v5_1hz/daily/YYYYMMDD
```

**é¦–æ¬¡é è™•ç†æ™‚é–“**: 30-60 åˆ†é˜ï¼ˆå–æ±ºæ–¼æ•¸æ“šé‡ï¼‰
**å¾ŒçºŒæŸ¥çœ‹æ™‚é–“**: 1-2 åˆ†é˜

---

## ğŸ¨ ç•Œé¢èªªæ˜

### æ§åˆ¶é¢æ¿ï¼ˆå·¦å´ï¼‰

1. **æ—¥æœŸç›®éŒ„è·¯å¾‘è¼¸å…¥**
   - è¼¸å…¥æ ¼å¼: `data/preprocessed_*/daily/YYYYMMDD`
   - ç¯„ä¾‹: `data/preprocessed_swing/daily/20250901`

2. **è¼‰å…¥ç›®éŒ„æŒ‰éˆ•**
   - é»æ“Šå¾Œæƒæä¸¦è¼‰å…¥è‚¡ç¥¨åˆ—è¡¨

3. **è‚¡ç¥¨é¸æ“‡ä¸‹æ‹‰é¸å–®**
   - `ğŸ“Š å…¨éƒ¨è‚¡ç¥¨`: æŸ¥çœ‹æ•´é«”çµ±è¨ˆ
   - `2330`, `2317`, ...: æŸ¥çœ‹å€‹åˆ¥è‚¡ç¥¨

4. **é¡¯ç¤ºé¸é …ï¼ˆå‹¾é¸æ¡†ï¼‰**
   - â˜‘ï¸ ä¸­é–“åƒ¹æŠ˜ç·šåœ–
   - â˜‘ï¸ æ¨™ç±¤é è¦½åˆ†å¸ƒ
   - â˜‘ï¸ å…ƒæ•¸æ“šè¡¨æ ¼

### åœ–è¡¨å€åŸŸï¼ˆå³å´ï¼‰

#### å–®ä¸€è‚¡ç¥¨æª¢è¦–

1. **ä¸­é–“åƒ¹æ™‚åºåœ–**
   - æŠ˜ç·šé¡¯ç¤ºåƒ¹æ ¼è®ŠåŒ–
   - ç–ŠåŠ æ¨™ç±¤é»ï¼š
     - ğŸ”´ ç´…è‰² = ä¸‹è·Œ (-1)
     - âšª ç°è‰² = æŒå¹³ (0)
     - ğŸŸ¢ ç¶ è‰² = ä¸Šæ¼² (1)

2. **æ¨™ç±¤åˆ†å¸ƒæŸ±ç‹€åœ–**
   - é¡¯ç¤ºä¸‰ç¨®æ¨™ç±¤çš„æ•¸é‡å’Œæ¯”ä¾‹

3. **å…ƒæ•¸æ“šè¡¨æ ¼**
   - è‚¡ç¥¨ä»£ç¢¼ã€æ—¥æœŸ
   - é–‹é«˜ä½æ”¶ã€æ³¢å‹•ç‡
   - éæ¿¾è³‡è¨Šã€æ¡æ¨£æ¨¡å¼

#### å…¨éƒ¨è‚¡ç¥¨æª¢è¦–

1. **æ•´é«”æ¨™ç±¤åˆ†å¸ƒ**
   - æ‰€æœ‰è‚¡ç¥¨çš„ç¸½æ¨™ç±¤åˆ†å¸ƒ

2. **å‰ 10 æª”è‚¡ç¥¨å †ç–Šåœ–**
   - æŒ‰æ¨™ç±¤æ•¸é‡æ’åº

3. **Summary.json çµ±è¨ˆ**
   - ç•¶å¤©æ‘˜è¦è³‡è¨Š

---

## ğŸ“‚ æ•¸æ“šä¾†æº

Label Viewer è®€å– `preprocess_single_day.py` ç”¢ç”Ÿçš„ NPZ æ–‡ä»¶ã€‚

### NPZ æ–‡ä»¶çµæ§‹

æ¯å€‹ NPZ æ–‡ä»¶åŒ…å«ï¼š

- **features**: (T, 20) LOB ç‰¹å¾µé™£åˆ—
- **mids**: (T,) ä¸­é–“åƒ¹é™£åˆ—
- **labels**: (T,) æ¨™ç±¤é™£åˆ—ï¼ˆ-1, 0, 1ï¼‰
- **metadata**: JSON æ ¼å¼çš„å…ƒæ•¸æ“š
  - `label_preview`: æ¨™ç±¤çµ±è¨ˆ
  - `labeling_method`: ä½¿ç”¨çš„æ¨™ç±¤æ–¹æ³•
  - `weight_strategies`: æ¬Šé‡ç­–ç•¥ï¼ˆ5 ç¨®ï¼‰

### å¦‚ä½•ç”Ÿæˆæ•¸æ“šï¼Ÿ

```batch
# æ–¹æ³• 1: æ‰¹æ¬¡è™•ç†æ‰€æœ‰æ•¸æ“šï¼ˆæ¨è–¦ï¼‰
scripts\batch_preprocess.bat

# æ–¹æ³• 2: è™•ç†å–®ä¸€å¤©æ•¸æ“š
python scripts\preprocess_single_day.py ^
    --input data\temp\20250901.txt ^
    --output-dir data\preprocessed_v5_1hz ^
    --config configs\config_pro_v5_ml_optimal.yaml
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å•é¡Œ 1: æ‰¾ä¸åˆ°æ•¸æ“šç›®éŒ„

**éŒ¯èª¤è¨Šæ¯**: `âŒ ç›®éŒ„ä¸å­˜åœ¨`

**è§£æ±ºæ–¹æ³•**:
```batch
# æª¢æŸ¥å¯ç”¨çš„æ•¸æ“šç›®éŒ„
dir /s /b data\preprocessed_*\daily

# å¦‚æœæ²’æœ‰æ•¸æ“šï¼ŒåŸ·è¡Œé è™•ç†
scripts\batch_preprocess.bat
```

---

### å•é¡Œ 2: ç„¡æ³•å•Ÿå‹• Conda ç’°å¢ƒ

**éŒ¯èª¤è¨Šæ¯**: `ç„¡æ³•å•Ÿå‹• conda ç’°å¢ƒ deeplob-pro`

**è§£æ±ºæ–¹æ³•**:
```batch
# æª¢æŸ¥ç’°å¢ƒ
conda info --envs | findstr "deeplob-pro"

# å¦‚æœä¸å­˜åœ¨ï¼Œå‰µå»ºç’°å¢ƒ
conda create -n deeplob-pro python=3.11
conda activate deeplob-pro
pip install dash plotly pandas numpy
```

---

### å•é¡Œ 3: æ²’æœ‰é¡¯ç¤ºæ¨™ç±¤

**å¯èƒ½åŸå› **:
- NPZ ä¸­æ²’æœ‰ `labels` éµ
- `metadata` ä¸­æ²’æœ‰ `label_preview`

**è§£æ±ºæ–¹æ³•**:
```batch
# é‡æ–°é è™•ç†æ•¸æ“šï¼ˆç¢ºä¿è¨ˆç®—æ¨™ç±¤ï¼‰
python scripts\preprocess_single_day.py ^
    --input data\temp\20250901.txt ^
    --output-dir data\preprocessed_v5_1hz ^
    --config configs\config_pro_v5_ml_optimal.yaml
```

---

### å•é¡Œ 4: åŸ è™Ÿè¡çª

**éŒ¯èª¤è¨Šæ¯**: `Address already in use`

**è§£æ±ºæ–¹æ³•**:
1. åœæ­¢å…¶ä»–ä½¿ç”¨ 8051 åŸ çš„æ‡‰ç”¨
2. æˆ–ä¿®æ”¹åŸ è™Ÿï¼ˆç·¨è¼¯ `label_viewer/app_preprocessed.py`ï¼‰

---

## ğŸ“š é€²éšåŠŸèƒ½

### 1. æ¯”è¼ƒä¸åŒæ¨™ç±¤æ–¹æ³•

```batch
# 1. ä½¿ç”¨ triple_barrier é è™•ç†
python scripts\preprocess_single_day.py ^
    --input data\temp\20250901.txt ^
    --output-dir data\preprocessed_tb ^
    --config configs\config_tb.yaml

# 2. ä½¿ç”¨ trend_stable é è™•ç†
python scripts\preprocess_single_day.py ^
    --input data\temp\20250901.txt ^
    --output-dir data\preprocessed_trend ^
    --config configs\config_trend.yaml

# 3. åœ¨ Label Viewer ä¸­åˆ†åˆ¥æŸ¥çœ‹
# data/preprocessed_tb/daily/20250901
# data/preprocessed_trend/daily/20250901
```

### 2. æŸ¥çœ‹æ¬Šé‡ç­–ç•¥

Label Viewer æœƒè‡ªå‹•é¡¯ç¤º 5 ç¨®æ¬Šé‡ç­–ç•¥ï¼š

1. **uniform**: ç„¡æ¬Šé‡ï¼ˆå…¨éƒ¨ 1.0ï¼‰
2. **balanced**: sklearn æ¨™æº–å¹³è¡¡æ¬Šé‡
3. **balanced_sqrt**: å¹³è¡¡æ¬Šé‡çš„å¹³æ–¹æ ¹
4. **inverse_freq**: åé »ç‡æ¬Šé‡
5. **focal_alpha**: Focal Loss é¢¨æ ¼æ¬Šé‡

é€™äº›æ¬Šé‡ç­–ç•¥å¯ç”¨æ–¼è¨“ç·´æ™‚çš„é¡åˆ¥å¹³è¡¡ã€‚

---

## ğŸ“ ç²å–å¹«åŠ©

### 1. æŸ¥çœ‹å®Œæ•´æ–‡æª”

```batch
# æ‰“é–‹å®Œæ•´ä½¿ç”¨æŒ‡å—
docs\LABEL_VIEWER_GUIDE.md

# æ‰“é–‹è…³æœ¬èªªæ˜
scripts\README_LABEL_VIEWER.md
```

### 2. ä½¿ç”¨å…§å»ºæª¢æŸ¥åŠŸèƒ½

```batch
# å•Ÿå‹•é¸å–®
scripts\label_viewer_menu.bat

# é¸æ“‡ [3] æª¢æŸ¥ç’°å¢ƒèˆ‡æ•¸æ“š
# æˆ–é¸æ“‡ [4] æŸ¥çœ‹ä½¿ç”¨èªªæ˜
```

### 3. è¯ç¹«æŠ€è¡“æ”¯æ´

å¦‚æœå•é¡Œä»æœªè§£æ±ºï¼Œè«‹æä¾›ï¼š
- éŒ¯èª¤è¨Šæ¯æˆªåœ–
- åŸ·è¡Œçš„å‘½ä»¤
- ç³»çµ±ç’°å¢ƒè³‡è¨Š

---

## ğŸ‰ é–‹å§‹ä½¿ç”¨

ç¾åœ¨ä½ å·²ç¶“æº–å‚™å¥½äº†ï¼

```batch
# æœ€ç°¡å–®çš„é–‹å§‹æ–¹å¼
scripts\label_viewer_menu.bat
```

é¸æ“‡é¸é …ï¼Œäº«å—è¦–è¦ºåŒ–æ¨™ç±¤çš„æ¨‚è¶£ï¼

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

---

**æ›´æ–°æ—¥æœŸ**: 2025-10-23
**ç‰ˆæœ¬**: v3.0
**ä½œè€…**: DeepLOB-Pro Team

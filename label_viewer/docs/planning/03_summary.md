# 標籤查看器專案規劃總結

## 📋 規劃完成文檔

已完成兩份詳細規劃文檔：

1. **功能規劃書**: [docs/interactive_label_viewer_specification.md](docs/interactive_label_viewer_specification.md)
   - 核心需求分析（v1.0 vs v2.0）
   - 技術選型（Plotly + Dash）
   - UI 設計與頁面布局
   - 功能模組設計（三階段開發）
   - 性能考量與優化策略

2. **目錄結構規劃**: [docs/label_viewer_project_structure.md](docs/label_viewer_project_structure.md)
   - 三種方案對比（推薦方案 A）
   - 詳細目錄說明
   - 模組化設計
   - 與主專案整合方式

---

## 🎯 推薦方案：獨立子目錄 `label_viewer/`

### 目錄結構預覽

```
DeepLOB-Pro/
├── configs/                    # 主專案配置
├── src/                        # 主專案源碼
├── scripts/                    # 主專案腳本
├── data/                       # 共用數據目錄
│
├── label_viewer/              # 🆕 標籤查看器（獨立子專案）
│   ├── README.md              # 子專案說明
│   ├── requirements.txt       # 獨立依賴（dash, plotly）
│   ├── app.py                 # Dash 主應用（約 300 行）
│   ├── start_viewer.bat       # Windows 快速啟動
│   │
│   ├── components/            # UI 組件模組（約 600 行）
│   │   ├── main_chart.py      # 主圖表（收盤價與標籤）
│   │   ├── label_timeline.py  # 標籤時間軸
│   │   ├── label_dist.py      # 標籤分布圖
│   │   └── weight_dist.py     # 權重分布圖
│   │
│   ├── utils/                 # 工具模組（約 400 行）
│   │   ├── data_loader.py     # 數據載入與 LRU 快取
│   │   ├── price_builder.py   # 收盤價重建（反向 Z-Score）
│   │   └── config.py          # 配置管理
│   │
│   ├── assets/                # 靜態資源（CSS）
│   │   └── style.css          # 自定義樣式
│   │
│   └── docs/                  # 子專案文檔
│       ├── usage.md           # 使用說明
│       └── screenshots/       # 截圖
│
└── LABEL_VIEWER_README.md     # 快速入口（指向 label_viewer/）
```

**總代碼量**：約 1,350 行（精簡設計）

---

## 🌟 核心優勢

### 1. 結構清晰 ✅
- 主專案（DeepLOB-Pro）專注於模型訓練
- 工具專案（label_viewer）專注於數據檢查
- 職責分離，易於維護

### 2. 獨立依賴 ✅
- 主專案：PyTorch, SB3, arch（重量級，約 2 GB）
- 工具專案：Dash, Plotly（輕量級，約 50 MB）
- 互不干擾

### 3. 數據共用 ✅
- 直接讀取 `../data/processed_v5/npz`
- 無需符號連結或複製數據
- 支援多數據源切換

### 4. 易於擴展 ✅
- 未來可添加其他工具（`tools/` 概念）
- 可輕鬆拆分成完全獨立專案
- 可單獨發佈到 PyPI

---

## 🚀 快速啟動（未來使用方式）

### Windows
```batch
# 進入工具目錄
cd label_viewer

# 一鍵啟動
start_viewer.bat

# 或手動啟動
conda activate deeplob-pro
python app.py
```

### 訪問
瀏覽器開啟：`http://localhost:8050`

---

## 📊 功能階段規劃

### 階段一：MVP（必須，2-3 小時）
- [x] 數據載入與快取
- [x] 股票選擇器（下拉選單）
- [x] 主圖表（收盤價與標籤趨勢）
- [x] 標籤分布圖
- [x] Web 服務器啟動

### 階段二：進階功能（建議，1-2 小時）
- [x] 數據集切換（train/val/test）
- [x] 時間範圍篩選（滑桿）
- [x] 標籤序列時間軸圖
- [x] 樣本權重分布圖
- [x] 資訊面板

### 階段三：高級功能（可選，2-3 小時）
- [ ] 標籤轉換點高亮（建議實作）
- [ ] 圖表下載功能（建議實作）
- [ ] 多股票對比（可選）
- [ ] 配置版本對比（可選）
- [ ] 搜尋與篩選（可選）

---

## ❓ 待您確認的事項

### 1. 目錄結構 ✅（已規劃）
- [x] 使用方案 A（`label_viewer/` 子目錄）
- [x] 獨立的 `requirements.txt` 和啟動腳本
- [x] 模組化設計（`components/` + `utils/`）

### 2. 功能範圍 ⏳（待確認）
**請選擇開發範圍**：
- [ ] **選項 A**：階段一 + 階段二（基礎 + 進階，約 3-5 小時）
- [ ] **選項 B**：階段一 + 階段二 + F3.2（標籤轉換點）+ F3.4（圖表下載）（約 4-6 小時）
- [ ] **選項 C**：完整開發（階段一 + 二 + 三，約 6-9 小時）

### 3. 特定功能優先級 ⏳（待確認）
以下功能是否需要？
- [ ] **F3.2 標籤轉換點高亮**（顯示標籤切換位置與原因 up/down/time）
  - 對除錯很有幫助，建議實作 ⭐

- [ ] **F3.4 圖表下載功能**（PNG/HTML）
  - 方便分享與報告，建議實作 ⭐

- [ ] **F3.3 配置版本對比**（同時比較 `v5` 和 `v5_balanced`）
  - 實用但複雜，可選

- [ ] **F3.1 多股票對比**（同時顯示多檔股票）
  - 視覺複雜，可選

### 4. 開發時間安排 ⏳（待確認）
- [ ] **立即開始**（今天完成 MVP）
- [ ] **分階段開發**（先完成階段一，確認可用後再繼續）
- [ ] **其他安排**：________________

---

## 📝 建議開發策略

我的建議是採用**分階段迭代**：

### 第一次迭代（今天，2-3 小時）
✅ **目標**：可用的 MVP
- 階段一：基礎功能（F1.1-F1.5）
- 測試與除錯
- 簡單的使用說明

**交付物**：
- 可運行的 Dash 應用
- 可切換股票查看標籤
- 基本圖表互動（縮放、懸停）

### 第二次迭代（視需求，1-2 小時）
✅ **目標**：完整功能
- 階段二：進階功能（F2.1-F2.5）
- 數據集切換、時間範圍篩選
- 完整使用文檔

**交付物**：
- 完整的互動式查看器
- 詳細使用說明
- 截圖與範例

### 第三次迭代（可選，2-3 小時）
⏳ **目標**：高級功能
- 階段三：F3.2（標籤轉換點）+ F3.4（圖表下載）
- 可選：F3.1、F3.3、F3.5

---

## 🎯 請您確認

請回覆以下任一選項，我將立即開始開發：

### 選項 A：快速 MVP（推薦）
```
「確認，開發階段一（MVP），先測試可用性」
```
- 開發範圍：階段一（F1.1-F1.5）
- 時間：2-3 小時
- 交付：可運行的基礎版本

### 選項 B：完整基礎版（推薦）
```
「確認，開發階段一+二，並加上 F3.2 和 F3.4」
```
- 開發範圍：階段一+二 + 標籤轉換點 + 圖表下載
- 時間：4-6 小時
- 交付：功能完整的實用版本

### 選項 C：完整開發
```
「確認，完整開發階段一+二+三」
```
- 開發範圍：所有功能
- 時間：6-9 小時
- 交付：包含所有高級功能

### 選項 D：自定義
```
「確認，開發階段一+二，並加上 [功能代號]」
例如：「確認，開發階段一+二，並加上 F3.2」
```

---

## 📚 相關文檔

- **功能規劃**: [interactive_label_viewer_specification.md](docs/interactive_label_viewer_specification.md)
- **目錄結構**: [label_viewer_project_structure.md](docs/label_viewer_project_structure.md)

---

**當前狀態**：⏳ 等待您確認開發範圍
**預計開始時間**：確認後立即開始
**預計完成時間**：根據選項而定（2-9 小時）

---

**版本**: v1.0
**日期**: 2025-10-20
**作者**: DeepLOB-Pro Team

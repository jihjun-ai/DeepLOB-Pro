# å¿«é€Ÿé–‹å§‹ - æŸ¥çœ‹é è™•ç†æ•¸æ“šæ¨™ç±¤

**ç›®æ¨™**: æŸ¥çœ‹ `preprocess_single_day.py` ç”¢ç”Ÿçš„ NPZ æ•¸æ“šå’Œæ¨™ç±¤

**ç‹€æ…‹**: âœ… åŠŸèƒ½å®Œæ•´å¯ç”¨

---

## ğŸš€ æœ€å¿«å•Ÿå‹•æ–¹å¼

```batch
# 1. é€²å…¥ label_viewer ç›®éŒ„
cd label_viewer

# 2. åŸ·è¡Œå•Ÿå‹•è…³æœ¬
start_preprocessed_viewer.bat

# 3. ç€è¦½å™¨è¨ªå•
http://localhost:8051
```

**å°±é€™éº¼ç°¡å–®ï¼** ğŸ‰

---

## ğŸ“– ä½¿ç”¨æ­¥é©Ÿ

### 1. å•Ÿå‹•æ‡‰ç”¨

```batch
cd label_viewer
start_preprocessed_viewer.bat
```

### 2. åœ¨ç€è¦½å™¨ä¸­æ“ä½œ

1. **è¼¸å…¥æ—¥æœŸç›®éŒ„è·¯å¾‘**
   ```
   ç¯„ä¾‹: data/preprocessed_swing/daily/20250901
   ```
   æˆ–è€…
   ```
   ç¯„ä¾‹: ../data/preprocessed_swing/daily/20250901
   ```

2. **é»æ“Šã€Œè¼‰å…¥ç›®éŒ„ã€æŒ‰éˆ•**
   - ç³»çµ±æœƒæƒæè©²ç›®éŒ„ä¸‹çš„æ‰€æœ‰ NPZ æ–‡ä»¶
   - é¡¯ç¤ºå¯ç”¨çš„è‚¡ç¥¨åˆ—è¡¨

3. **é¸æ“‡æŸ¥çœ‹æ–¹å¼**
   - **ğŸ“Š å…¨éƒ¨è‚¡ç¥¨** - æŸ¥çœ‹æ•´é«”æ¨™ç±¤çµ±è¨ˆ
   - **å€‹åˆ¥è‚¡ç¥¨**ï¼ˆå¦‚ 0050, 2330ï¼‰ - æŸ¥çœ‹è©³ç´°è³‡æ–™

4. **å‹¾é¸é¡¯ç¤ºé …ç›®**
   - â˜‘ï¸ ä¸­é–“åƒ¹æŠ˜ç·šåœ– - æ™‚åºåƒ¹æ ¼åœ–ï¼ˆå«æ¨™ç±¤ç–ŠåŠ ï¼‰
   - â˜‘ï¸ æ¨™ç±¤é è¦½åˆ†å¸ƒ - æŸ±ç‹€åœ–é¡¯ç¤ºæ¨™ç±¤çµ±è¨ˆ
   - â˜‘ï¸ å…ƒæ•¸æ“šè¡¨æ ¼ - è‚¡ç¥¨è©³ç´°è³‡è¨Š

---

## ğŸ¨ ç•Œé¢èªªæ˜

### ä¸­é–“åƒ¹æŠ˜ç·šåœ–ï¼ˆå«æ¨™ç±¤ç–ŠåŠ ï¼‰

```
åƒ¹æ ¼ â–²
    â”‚     ğŸŸ¢
    â”‚   /    \   ğŸ”´
    â”‚  /  âšª  \ /
    â”‚ /        V
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º æ™‚é–“

åœ–ä¾‹:
ğŸ”´ ç´…è‰²é» = Down (-1) - åƒ¹æ ¼ä¸‹è·Œ
âšª ç°è‰²é» = Neutral (0) - åƒ¹æ ¼æŒå¹³
ğŸŸ¢ ç¶ è‰²é» = Up (1) - åƒ¹æ ¼ä¸Šæ¼²
```

### æ¨™ç±¤åˆ†å¸ƒæŸ±ç‹€åœ–

```
æ•¸é‡
    â–²
    â”‚  â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆ
    â”‚  â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ
    â”‚  â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ
    â”‚  â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
      Down   Neutral   Up
     (31.5%) (35.7%) (32.8%)
```

### å…ƒæ•¸æ“šè¡¨æ ¼

é¡¯ç¤ºä»¥ä¸‹è³‡è¨Šï¼š
- è‚¡ç¥¨ä»£ç¢¼ã€æ—¥æœŸ
- æ•¸æ“šé»æ•¸ï¼ˆä¾‹å¦‚ 15,957 å€‹æ™‚é–“é»ï¼‰
- æ³¢å‹•ç¯„åœï¼ˆä¾‹å¦‚ 2.34%ï¼‰
- æ—¥å…§æ”¶ç›Šç‡
- é–‹é«˜ä½æ”¶åƒ¹æ ¼
- æ˜¯å¦é€šééæ¿¾
- éæ¿¾é–¾å€¼å’Œæ–¹æ³•
- 1Hz èšåˆçµ±è¨ˆï¼ˆå‰å‘å¡«å……ã€ç¼ºå¤±æ¯”ä¾‹ç­‰ï¼‰

---

## ğŸ“‚ æ•¸æ“šç›®éŒ„ç¯„ä¾‹

### å¯ç”¨çš„é è™•ç†æ•¸æ“šç›®éŒ„

```bash
# è¶¨å‹¢æ¨™ç±¤ï¼ˆæ³¢æ®µäº¤æ˜“ï¼‰- æ¨è–¦
data/preprocessed_swing/daily/20250901

# Triple-Barrier æ¨™ç±¤ï¼ˆé«˜é »äº¤æ˜“ï¼‰
data/preprocessed_v5_1hz/daily/20250901

# æ¸¬è©¦æ•¸æ“š
data/preprocessed_v5_test/daily/20240930
```

### ç›®éŒ„çµæ§‹

```
data/preprocessed_swing/daily/20250901/
â”œâ”€â”€ 0050.npz          # NPZ æ–‡ä»¶
â”œâ”€â”€ 2330.npz
â”œâ”€â”€ 2317.npz
â”œâ”€â”€ ...
â””â”€â”€ summary.json      # ç•¶å¤©æ‘˜è¦ï¼ˆå¯é¸ï¼‰
```

---

## ğŸ” æª¢æŸ¥æ¨™ç±¤æ­£ç¢ºæ€§

### âœ… æ­£ç¢ºæ¨™ç±¤çš„ç‰¹å¾µ

åœ¨ã€Œä¸­é–“åƒ¹æŠ˜ç·šåœ–ã€ä¸­æª¢æŸ¥ï¼š

1. **åƒ¹æ ¼ä¸Šå‡éšæ®µ** â†’ ä¸»è¦æ˜¯ç¶ è‰²é»ï¼ˆUpï¼‰
2. **åƒ¹æ ¼ä¸‹é™éšæ®µ** â†’ ä¸»è¦æ˜¯ç´…è‰²é»ï¼ˆDownï¼‰
3. **åƒ¹æ ¼æ©«ç›¤éšæ®µ** â†’ ä¸»è¦æ˜¯ç°è‰²é»ï¼ˆNeutralï¼‰

### âŒ ç•°å¸¸æ¨™ç±¤çš„ç‰¹å¾µ

1. **æ¨™ç±¤èˆ‡è¶¨å‹¢ç›¸å**
   - åƒ¹æ ¼ä¸Šå‡å»æ¨™è¨˜ç‚º Downï¼ˆç´…è‰²ï¼‰
   - åƒ¹æ ¼ä¸‹é™å»æ¨™è¨˜ç‚º Upï¼ˆç¶ è‰²ï¼‰

2. **æ¨™ç±¤éæ–¼é›†ä¸­**
   - Neutral > 70%ï¼ˆå¤§éƒ¨åˆ†æ˜¯ç°è‰²ï¼‰
   - åŸå› : `min_return` é–¾å€¼è¨­ç½®éé«˜

3. **æ¨™ç±¤éæ–¼è·³å‹•**
   - æ¯å€‹æ™‚é–“é»æ¨™ç±¤éƒ½ä¸åŒï¼ˆåƒå½©è™¹ï¼‰
   - åŸå› : åƒæ•¸è¨­ç½®ä¸ç•¶

---

## ğŸ“Š æ¨™ç±¤æ–¹æ³•è­˜åˆ¥

æ‡‰ç”¨æœƒè‡ªå‹•è­˜åˆ¥ä½¿ç”¨çš„æ¨™ç±¤æ–¹æ³•ï¼ˆå¾ metadata ä¸­è®€å–ï¼‰ï¼š

| æ¨™ç±¤æ–¹æ³• | é©ç”¨å ´æ™¯ | äº¤æ˜“é »ç‡ |
|---------|---------|---------|
| **triple_barrier** | é«˜é »äº¤æ˜“ | 10-20æ¬¡/å¤© |
| **trend_adaptive** | æ—¥å…§æ³¢æ®µ | 1-2æ¬¡/å¤© |
| **trend_stable** | æ—¥å…§æ³¢æ®µï¼ˆç©©å®šç‰ˆï¼‰| 1-2æ¬¡/å¤©ï¼ˆæ¨è–¦ï¼‰|

---

## ğŸ”§ å¸¸è¦‹å•é¡Œ

### Q1: æ‰¾ä¸åˆ°ç›®éŒ„

**éŒ¯èª¤è¨Šæ¯**: `âŒ ç›®éŒ„ä¸å­˜åœ¨: data/preprocessed_swing/daily/20250901`

**è§£æ±ºæ–¹æ³•**:
1. æª¢æŸ¥è·¯å¾‘æ˜¯å¦æ­£ç¢ºï¼ˆä½¿ç”¨ `/` è€Œé `\`ï¼‰
2. ç¢ºä¿å·²åŸ·è¡Œ `preprocess_single_day.py` æˆ– `batch_preprocess.bat`
3. ä½¿ç”¨çµ•å°è·¯å¾‘æˆ–å¾ `label_viewer` ç›®éŒ„çš„ç›¸å°è·¯å¾‘

### Q2: æ²’æœ‰é¡¯ç¤ºæ¨™ç±¤é»

**å¯èƒ½åŸå› **:
1. NPZ ä¸­æ²’æœ‰ `labels` éµ
2. `metadata` ä¸­æ²’æœ‰ `label_preview`

**è§£æ±ºæ–¹æ³•**:
- ç¢ºä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ `preprocess_single_day.py`
- é‡æ–°åŸ·è¡Œé è™•ç†ï¼ˆç¢ºä¿è¨ˆç®—æ¨™ç±¤ï¼‰

### Q3: æ‡‰ç”¨ç„¡æ³•å•Ÿå‹•

**å¯èƒ½åŸå› **:
1. åŸ è™Ÿ 8051 è¢«ä½”ç”¨
2. Conda ç’°å¢ƒæœªå•Ÿå‹•

**è§£æ±ºæ–¹æ³•**:
```batch
# æ‰‹å‹•å•Ÿå‹•ç’°å¢ƒ
conda activate deeplob-pro

# æª¢æŸ¥åŸ è™Ÿ
netstat -ano | findstr "8051"

# æˆ–ä¿®æ”¹åŸ è™Ÿï¼ˆç·¨è¼¯ app_preprocessed.pyï¼‰
```

---

## ğŸ’¡ ä½¿ç”¨å»ºè­°

### 1. æ¯æ¬¡é è™•ç†å¾Œç«‹å³æª¢æŸ¥

```batch
# 1. é è™•ç†
python scripts\preprocess_single_day.py ^
    --input data\temp\20250901.txt ^
    --output-dir data\preprocessed_v5_1hz ^
    --config configs\config_pro_v5_ml_optimal.yaml

# 2. ç«‹å³æª¢æŸ¥
cd label_viewer
start_preprocessed_viewer.bat

# 3. åœ¨ç€è¦½å™¨è¼¸å…¥è·¯å¾‘
# data/preprocessed_v5_1hz/daily/20250901
```

### 2. æ¯”è¼ƒä¸åŒæ¨™ç±¤æ–¹æ³•

```
# 1. åœ¨ viewer ä¸­è¼‰å…¥ triple_barrier æ•¸æ“š
data/preprocessed_v5_1hz/daily/20250901

# 2. è¨˜éŒ„æ¨™ç±¤åˆ†å¸ƒ

# 3. è¼‰å…¥ trend_stable æ•¸æ“š
data/preprocessed_swing/daily/20250901

# 4. æ¯”è¼ƒå…©ç¨®æ–¹æ³•çš„æ¨™ç±¤åˆ†å¸ƒå·®ç•°
```

### 3. æª¢æŸ¥æ•´é«”æ¨™ç±¤åˆ†å¸ƒ

```
# 1. è¼‰å…¥ç›®éŒ„å¾Œé¸æ“‡ã€ŒğŸ“Š å…¨éƒ¨è‚¡ç¥¨ã€
# 2. æŸ¥çœ‹æ•´é«”æ¨™ç±¤åˆ†å¸ƒæŸ±ç‹€åœ–
# 3. ç¢ºèªæ¨™ç±¤åˆ†å¸ƒæ˜¯å¦ç¬¦åˆé æœŸï¼ˆä¾‹å¦‚ 30/40/30ï¼‰
```

---

## ğŸ“š ç›¸é—œæ–‡æª”

### åœ¨ label_viewer å°ˆæ¡ˆå…§

- [README.md](README.md) - å°ˆæ¡ˆç¸½è¦½
- [TEST_PREPROCESSED_VIEWER.md](TEST_PREPROCESSED_VIEWER.md) - æ¸¬è©¦å ±å‘Š
- [QUICKSTART.md](QUICKSTART.md) - å¿«é€Ÿé–‹å§‹ï¼ˆapp.py ç‰ˆæœ¬ï¼‰

### åœ¨ä¸»å°ˆæ¡ˆä¸­

- [../docs/LABEL_VIEWER_GUIDE.md](../docs/LABEL_VIEWER_GUIDE.md) - å®Œæ•´ä½¿ç”¨æŒ‡å—
- [../scripts/README_LABEL_VIEWER.md](../scripts/README_LABEL_VIEWER.md) - è…³æœ¬èªªæ˜
- [../QUICK_START_LABEL_VIEWER.md](../QUICK_START_LABEL_VIEWER.md) - ä¸»å°ˆæ¡ˆå¿«é€Ÿé–‹å§‹

---

## ğŸ¯ å°æ¯”èªªæ˜

### label_viewer å°ˆæ¡ˆå…§æœ‰å…©å€‹æ‡‰ç”¨

| æ‡‰ç”¨ | æ•¸æ“šä¾†æº | ç”¨é€” | å•Ÿå‹•æ–¹å¼ |
|-----|---------|------|---------|
| **app.py** | extract_tw_stock_data_v5.py | æŸ¥çœ‹è¨“ç·´æ•¸æ“šæ¨™ç±¤ | start_viewer.bat |
| **app_preprocessed.py** | preprocess_single_day.py | æŸ¥çœ‹é è™•ç†æ•¸æ“šæ¨™ç±¤ | start_preprocessed_viewer.bat |

**æœ¬æ–‡æª”èªªæ˜**: app_preprocessed.pyï¼ˆæŸ¥çœ‹é è™•ç†æ•¸æ“šï¼‰

---

## âœ… ç¢ºèªæ¸…å–®

é–‹å§‹ä½¿ç”¨å‰ï¼Œç¢ºèªä»¥ä¸‹äº‹é …ï¼š

- [ ] å·²å•Ÿå‹• Conda ç’°å¢ƒï¼ˆdeeplob-proï¼‰
- [ ] å·²åŸ·è¡Œé è™•ç†è…³æœ¬ï¼ˆpreprocess_single_day.py æˆ– batch_preprocess.batï¼‰
- [ ] æœ‰å¯ç”¨çš„é è™•ç†æ•¸æ“šç›®éŒ„
- [ ] ç€è¦½å™¨å¯ä»¥è¨ªå• localhost:8051

---

## ğŸ‰ é–‹å§‹ä½¿ç”¨

```batch
cd label_viewer
start_preprocessed_viewer.bat
```

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

---

**æ›´æ–°æ—¥æœŸ**: 2025-10-23
**ç‰ˆæœ¬**: v3.0
**ä½œè€…**: DeepLOB-Pro Team

# æ»‘çª—é‡ç–Šæ´©æ¼å•é¡Œ

**æ—¥æœŸ**: 2025-10-21
**å•é¡Œ**: å³ä½¿ä½¿ç”¨æ™‚é–“åºåˆ—åˆ‡åˆ†ï¼Œæ´©æ¼æ¸¬è©¦ä»ç„¶å¤±æ•—

---

## ðŸ” å•é¡Œç™¼ç¾

### æ™‚é–“åºåˆ—åˆ‡åˆ†å·²æ­£ç¢ºå¯¦æ–½ âœ…

æ•¸æ“šç”Ÿæˆæ—¥èªŒé¡¯ç¤ºï¼š
```
æ™‚é–“åºåˆ—åˆ‡åˆ†:
  è¨“ç·´æ—¥æœŸ: 20250901 ~ 20250909 (7å¤©)
  é©—è­‰æ—¥æœŸ: 20250910 ~ 20250911 (2å¤©)
  æ¸¬è©¦æ—¥æœŸ: 20250912 ~ 20250912 (1å¤©)
```

### ä½†æ´©æ¼æ¸¬è©¦ä»å¤±æ•— âŒ

```
æª¢æŸ¥ 2: æœªä¾†è³‡è¨Šæ´©æ¼æ¸¬è©¦
  åŸºæº–æ¨¡åž‹ï¼ˆæ­£å¸¸å°é½Šï¼‰: æº–ç¢ºçŽ‡ 0.594 (59.4%)
  æ¸¬è©¦ A: æ™‚é–“æ‰“äº‚æ¨™ç±¤:    æº–ç¢ºçŽ‡ 0.538 (53.8%)
  ä¸‹é™å¹…åº¦: 0.056 (5.6%)
  çµæžœ: âŒ å¤±æ•— - æ‰“äº‚å¾Œä»é«˜æº–ç¢ºçŽ‡ï¼Œå¯èƒ½æœ‰æ´©æ¼
```

**æœŸæœ›**: ä¸‹é™å¹…åº¦ > 10%ï¼ˆæ‰“äº‚å¾Œæ‡‰æŽ¥è¿‘éš¨æ©Ÿ 33%ï¼‰
**å¯¦éš›**: ä¸‹é™å¹…åº¦åƒ… 5.6%ï¼ˆæ‰“äº‚å¾Œä» 53.8%ï¼‰

---

## ðŸŽ¯ æ ¹æœ¬åŽŸå› ï¼šæ»‘çª—é‡ç–Šæ´©æ¼

### å•é¡Œæ©Ÿåˆ¶

å³ä½¿è¨“ç·´é›†å’Œæ¸¬è©¦é›†**æŒ‰æ™‚é–“å®Œå…¨åˆ†é›¢**ï¼Œæ»‘çª—é‡ç–Šä»æœƒå°Žè‡´**åŒä¸€é›†åˆå…§éƒ¨æ´©æ¼**ï¼

### è¦–è¦ºåŒ–èªªæ˜Ž

**ç•¶å‰å¯¦ä½œ**ï¼ˆæ­¥é•· = 1ï¼‰ï¼š
```
åŒä¸€å¤©å…§çš„æ»‘çª—ï¼ˆä¾‹å¦‚ Day 1ï¼‰:
t=0    [ç‰¹å¾µ0, ç‰¹å¾µ1, ..., ç‰¹å¾µ99] â†’ æ¨™ç±¤99
t=1    [ç‰¹å¾µ1, ç‰¹å¾µ2, ..., ç‰¹å¾µ100] â†’ æ¨™ç±¤100
t=2    [ç‰¹å¾µ2, ç‰¹å¾µ3, ..., ç‰¹å¾µ101] â†’ æ¨™ç±¤101
       â””â”€â”€â”€â”€â”€â”€ 99% ç‰¹å¾µé‡ç–Šï¼ â”€â”€â”€â”€â”€â”€â”˜
```

### æ´©æ¼åŽŸç†

1. **ç‰¹å¾µé«˜åº¦ç›¸ä¼¼**
   ```python
   window_1 = [ç‰¹å¾µ0, ç‰¹å¾µ1, ..., ç‰¹å¾µ99]
   window_2 = [ç‰¹å¾µ1, ç‰¹å¾µ2, ..., ç‰¹å¾µ100]
   ç›¸é—œæ€§ = 99/100 = 99%
   ```

2. **æ¨¡åž‹å­¸åˆ°éŒ¯èª¤æ¨¡å¼**
   - æ¨¡åž‹å­¸ç¿’ï¼šã€Œç›¸ä¼¼ç‰¹å¾µ â†’ ç›¸ä¼¼æ¨™ç±¤ã€
   - è€ŒéžçœŸæ­£çš„ï¼šã€Œç‰¹å¾µæ¨¡å¼ â†’ åƒ¹æ ¼è®Šå‹•ã€

3. **æ‰“äº‚æ¨™ç±¤ä»æœ‰æ•ˆ**
   ```
   æ‰“äº‚å‰ï¼š
   window_1 â†’ label_1
   window_2 â†’ label_2 (æ‡‰è©²ç›¸ä¼¼ï¼Œå› ç‚ºç‰¹å¾µç›¸ä¼¼)

   æ‰“äº‚å¾Œï¼š
   window_1 â†’ label_X
   window_2 â†’ label_Y (å¯èƒ½ä¸åŒï¼Œä½†æ¨¡åž‹ä»èƒ½çŒœå°ä¸€éƒ¨åˆ†)
   ```

   **åŽŸå› **: æ¨¡åž‹åˆ©ç”¨ã€Œç‰¹å¾µé–“çš„ç›¸ä¼¼æ€§ã€ä¾†é æ¸¬ï¼Œè€ŒéžçœŸæ­£ç†è§£åƒ¹æ ¼è®Šå‹•

---

## ðŸ› ï¸ è§£æ±ºæ–¹æ¡ˆï¼šå¢žåŠ æ»‘çª—æ­¥é•·

### ä¿®æ”¹ 1: é…ç½®æ–‡ä»¶

**æ–‡ä»¶**: `configs/config_pro_v5_ml_optimal.yaml`

```yaml
data:
  seq_len: 100
  slide_step: 10  # æ–°å¢žï¼æ»‘çª—æ­¥é•·

  # èªªæ˜Žï¼š
  #   - slide_step=1:   æ­¥é•· 1ï¼ˆ99% é‡ç–Šï¼Œå¯èƒ½æ´©æ¼ï¼‰
  #   - slide_step=10:  æ­¥é•· 10ï¼ˆ90% æ¸›å°‘ï¼Œé™ä½Žæ´©æ¼ï¼‰
  #   - slide_step=100: æ­¥é•· 100ï¼ˆç„¡é‡ç–Šï¼Œä½†æ¨£æœ¬æ•¸å¤§æ¸›ï¼‰
  #   - æŽ¨è–¦å€¼ï¼š10ï¼ˆå¹³è¡¡æ´©æ¼é¢¨éšªèˆ‡æ¨£æœ¬æ•¸ï¼‰
```

### ä¿®æ”¹ 2: ä»£ç¢¼å¯¦ç¾

**æ–‡ä»¶**: `scripts/extract_tw_stock_data_v6.py`

**ä¿®æ”¹ä½ç½®**: ç¬¬ 867-909 è¡Œï¼ˆæ»‘çª—ç”Ÿæˆï¼‰

```python
# èˆŠä»£ç¢¼ï¼ˆæ­¥é•· = 1ï¼‰
for t in range(SEQ_LEN - 1, max_t):
    window_start = t - SEQ_LEN + 1
    # ...

# æ–°ä»£ç¢¼ï¼ˆå¯é…ç½®æ­¥é•·ï¼‰
slide_step = config.get('data', {}).get('slide_step', 1)
for t in range(SEQ_LEN - 1, max_t, slide_step):  # åŠ ä¸Šæ­¥é•·ï¼
    window_start = t - SEQ_LEN + 1
    # ...
```

### å½±éŸ¿åˆ†æž

| æ­¥é•· | é‡ç–ŠçŽ‡ | æ¨£æœ¬æ•¸å½±éŸ¿ | æ´©æ¼é¢¨éšª | æŽ¨è–¦åº¦ |
|------|--------|-----------|---------|--------|
| 1    | 99%    | 100%      | âš ï¸ é«˜    | âŒ     |
| 5    | 95%    | 20%       | âš ï¸ ä¸­    | â­â­â­ |
| 10   | 90%    | 10%       | âœ… ä½Ž    | â­â­â­â­â­ |
| 50   | 50%    | 2%        | âœ… æ¥µä½Ž  | â­â­â­  |
| 100  | 0%     | 1%        | âœ… ç„¡    | â­â­   |

**æŽ¨è–¦**: `slide_step=10`
- æ¨£æœ¬æ•¸æ¸›å°‘è‡³ 10%ï¼ˆç´„ 90 è¬æ¨£æœ¬ï¼Œä»è¶³å¤ ï¼‰
- é‡ç–ŠçŽ‡é™è‡³ 90%ï¼ˆç›¸é—œæ€§å¤§å¹…ä¸‹é™ï¼‰
- é æœŸæ´©æ¼æ¸¬è©¦é€šéŽï¼ˆä¸‹é™å¹…åº¦ > 15%ï¼‰

---

## ðŸ“Š é æœŸæ”¹å–„

### æ¨£æœ¬æ•¸è®ŠåŒ–

**ä¿®æ­£å‰**ï¼ˆæ­¥é•· = 1ï¼‰:
```
è¨“ç·´é›†: ~6,300,000 æ¨£æœ¬
é©—è­‰é›†: ~1,950,000 æ¨£æœ¬
æ¸¬è©¦é›†: ~900,000 æ¨£æœ¬
```

**ä¿®æ­£å¾Œ**ï¼ˆæ­¥é•· = 10ï¼‰:
```
è¨“ç·´é›†: ~630,000 æ¨£æœ¬ï¼ˆæ¸›å°‘ 90%ï¼‰
é©—è­‰é›†: ~195,000 æ¨£æœ¬
æ¸¬è©¦é›†: ~90,000 æ¨£æœ¬
```

**èªªæ˜Ž**: æ¨£æœ¬æ•¸é›–æ¸›å°‘ï¼Œä½†ä»é è¶…éŽæ·±åº¦å­¸ç¿’è¨“ç·´éœ€æ±‚ï¼ˆé€šå¸¸ 10 è¬æ¨£æœ¬å·²è¶³å¤ ï¼‰

### æ´©æ¼æ¸¬è©¦é æœŸ

**ä¿®æ­£å‰**:
```
åŸºæº–æº–ç¢ºçŽ‡: 59.4%
æ‰“äº‚å¾Œæº–ç¢ºçŽ‡: 53.8%
ä¸‹é™å¹…åº¦: 5.6% âŒ
```

**ä¿®æ­£å¾Œ**ï¼ˆé æœŸï¼‰:
```
åŸºæº–æº–ç¢ºçŽ‡: 50-55%ï¼ˆå¯èƒ½ç•¥é™ï¼‰
æ‰“äº‚å¾Œæº–ç¢ºçŽ‡: 33-40%ï¼ˆæŽ¥è¿‘éš¨æ©Ÿï¼‰
ä¸‹é™å¹…åº¦: > 15% âœ…
```

### ç›¸é„°çª—å£ç›¸é—œæ€§

**ä¿®æ­£å‰**ï¼ˆæ­¥é•· = 1ï¼‰:
```
window_1 èˆ‡ window_2 çš„ç‰¹å¾µç›¸é—œæ€§: 0.99ï¼ˆ99%ï¼‰
```

**ä¿®æ­£å¾Œ**ï¼ˆæ­¥é•· = 10ï¼‰:
```
window_1 èˆ‡ window_2 çš„ç‰¹å¾µç›¸é—œæ€§: 0.10ï¼ˆ10%ï¼‰
```

---

## ðŸŽ¯ åŸ·è¡Œè¨ˆç•«

### æ­¥é©Ÿ 1: ä¿®æ”¹é…ç½® âœ…

```bash
# å·²å®Œæˆ
# æ–°å¢ž data.slide_step: 10
```

### æ­¥é©Ÿ 2: ä¿®æ”¹ä»£ç¢¼ âœ…

```bash
# å·²å®Œæˆ
# ä¿®æ”¹æ»‘çª—ç”Ÿæˆé‚è¼¯ï¼Œæ”¯æŒå¯é…ç½®æ­¥é•·
```

### æ­¥é©Ÿ 3: é‡æ–°ç”Ÿæˆæ•¸æ“š â³

```bash
conda activate deeplob-pro
python scripts/extract_tw_stock_data_v6.py \
    --preprocessed-dir ./data/preprocessed_v5_1hz \
    --output-dir ./data/processed_v6_final \
    --config ./configs/config_pro_v5_ml_optimal.yaml
```

**é è¨ˆæ™‚é–“**: ~10-15 åˆ†é˜ï¼ˆæ¨£æœ¬æ•¸æ¸›å°‘ï¼Œé€Ÿåº¦æ›´å¿«ï¼‰

### æ­¥é©Ÿ 4: é©—è­‰æ”¹å–„

```bash
python scripts/data_health_check.py \
    --train-npz data/processed_v6_final/npz/stock_embedding_train.npz \
    --val-npz data/processed_v6_final/npz/stock_embedding_val.npz \
    --test-npz data/processed_v6_final/npz/stock_embedding_test.npz \
    --output-dir data/processed_v6_final/health_check
```

**é©—æ”¶æ¨™æº–**:
- âœ… æª¢æŸ¥ 2ï¼ˆæ´©æ¼æ¸¬è©¦ï¼‰: ä¸‹é™å¹…åº¦ > 10%
- âœ… æª¢æŸ¥ 4ï¼ˆç©©å®šæ€§ï¼‰: PSI < 0.1
- âœ… ç¸½é«”è©•ä¼°: é€šéŽ

---

## ðŸ’¡ é—œéµæ´žå¯Ÿ

### 1. æ™‚é–“åˆ‡åˆ†ä¸å¤ 

**åƒ…æŒ‰æ™‚é–“åˆ‡åˆ†è¨“ç·´/æ¸¬è©¦é›†æ˜¯ä¸å¤ çš„ï¼**

```
âœ… è¨“ç·´é›†ï¼ˆDay 1-7ï¼‰å’Œæ¸¬è©¦é›†ï¼ˆDay 10ï¼‰æ™‚é–“åˆ†é›¢
âŒ è¨“ç·´é›†**å…§éƒ¨**çš„ Day 1 ä»æœ‰æ»‘çª—é‡ç–Šæ´©æ¼
```

### 2. æ»‘çª—é‡ç–Šæ˜¯ç¨ç«‹å•é¡Œ

**æ»‘çª—é‡ç–Šæ´©æ¼ â‰  æ™‚é–“æ´©æ¼**

- **æ™‚é–“æ´©æ¼**: è¨“ç·´é›†åŒ…å«æ¸¬è©¦é›†çš„æœªä¾†ä¿¡æ¯
  - è§£æ±º: æ™‚é–“åºåˆ—åˆ‡åˆ† âœ…

- **æ»‘çª—æ´©æ¼**: ç›¸é„°æ¨£æœ¬ç‰¹å¾µé«˜åº¦ç›¸ä¼¼
  - è§£æ±º: å¢žåŠ æ»‘çª—æ­¥é•· âœ…

### 3. å…©è€…å¿…é ˆåŒæ™‚è§£æ±º

```
åªç”¨æ™‚é–“åˆ‡åˆ†:     æ´©æ¼æ¸¬è©¦ä»å¤±æ•— âŒ
åªç”¨æ»‘çª—æ­¥é•·:     å¯èƒ½æœ‰æ™‚é–“æ´©æ¼ âŒ
å…©è€…éƒ½ç”¨:         æ´©æ¼å®Œå…¨æ¶ˆé™¤ âœ…
```

---

## ðŸ”— ç›¸é—œæ–‡æª”

- [æ•¸æ“šæ´©æ¼å•é¡Œè§£æ±ºæ–¹æ¡ˆ](æ•¸æ“šæ´©æ¼å•é¡Œè§£æ±ºæ–¹æ¡ˆ.md) - æ™‚é–“æ´©æ¼éƒ¨åˆ†
- [2025-10-21_æ•¸æ“šè³ªé‡æ”¹é€²è¨˜éŒ„](2025-10-21_æ•¸æ“šè³ªé‡æ”¹é€²è¨˜éŒ„.md) - å®Œæ•´æ”¹é€²è¨˜éŒ„

---

**æœ€å¾Œæ›´æ–°**: 2025-10-21
**ç‹€æ…‹**: ä»£ç¢¼ä¿®æ”¹å®Œæˆï¼Œå¾…é‡æ–°ç”Ÿæˆæ•¸æ“šé©—è­‰
**ä¸‹ä¸€æ­¥**: åŸ·è¡Œæ­¥é©Ÿ 3ï¼ˆé‡æ–°ç”Ÿæˆæ•¸æ“šï¼‰
